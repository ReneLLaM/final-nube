â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘          ğŸš€ CHAT EN TIEMPO REAL - DESPLIEGUE EN UBUNTU                    â•‘
â•‘                                                                            â•‘
â•‘                    Â¡LISTA PARA PRODUCCIÃ“N!                                â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ“‹ TABLA DE CONTENIDOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Â¿QUÃ‰ SE HIZO?
2. ARCHIVOS CREADOS
3. CÃ“MO DESPLEGAR
4. CÃ“MO MONITOREAR
5. ESTRUCTURA DE ARQUITECTURA


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  Â¿QUÃ‰ SE HIZO?
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Creada arquitectura escalable con:
   â€¢ NGINX como balanceador de carga (reverse proxy)
   â€¢ Backend que se escala automÃ¡ticamente (1-5 rÃ©plicas)
   â€¢ Frontend que puede escalarse si es necesario
   â€¢ PostgreSQL como BD Ãºnica compartida
   â€¢ Crontab que ejecuta autoescalado cada 2 minutos

âœ… Implementado autoescalado automÃ¡tico:
   â€¢ Script para backend: autoscale-backend.sh
   â€¢ Script para frontend: autoscale-frontend.sh
   â€¢ Basado en CPU, Memoria y conexiones activas
   â€¢ Sistema de cooldown para evitar oscilaciones

âœ… Creada documentaciÃ³n completa:
   â€¢ DEPLOYMENT_UBUNTU.md - GuÃ­a completa (â­ LEER PRIMERO)
   â€¢ QUICK_START.md - GuÃ­a rÃ¡pida
   â€¢ ARQUITECTURA.md - Diagramas y explicaciÃ³n
   â€¢ RESUMEN_CAMBIOS.md - Cambios realizados

âœ… Creados scripts de instalaciÃ³n:
   â€¢ install-ubuntu.sh - InstalaciÃ³n automÃ¡tica
   â€¢ reload-nginx.sh - Recarga de Nginx
   â€¢ Todos los scripts existentes mejorados


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2ï¸âƒ£  ARCHIVOS CREADOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š DOCUMENTACIÃ“N (Lee en este orden):
   1. DEPLOYMENT_UBUNTU.md      â­ GUÃA COMPLETA - COMIENZA AQUÃ
   2. QUICK_START.md            âš¡ InstalaciÃ³n rÃ¡pida (5 minutos)
   3. ARQUITECTURA.md           ğŸ“ Diagramas y explicaciÃ³n
   4. RESUMEN_CAMBIOS.md        ğŸ“‹ Cambios realizados
   5. README.md                 â„¹ï¸  InformaciÃ³n general

ğŸ”§ SCRIPTS NUEVOS:
   â€¢ scripts/autoscale-backend.sh      Autoescalado de backend
   â€¢ scripts/autoscale-frontend.sh     Autoescalado de frontend
   â€¢ scripts/install-ubuntu.sh         InstalaciÃ³n automÃ¡tica
   â€¢ scripts/reload-nginx.sh           Recarga de Nginx

ğŸ”„ ARCHIVOS MODIFICADOS:
   â€¢ nginx/nginx.conf                  Upstream configurado
   â€¢ config/autoscale.conf             ParÃ¡metros de autoescalado


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

3ï¸âƒ£  CÃ“MO DESPLEGAR EN UBUNTU
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OPCIÃ“N A: InstalaciÃ³n AutomÃ¡tica (RECOMENDADO)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Conectarse al servidor Ubuntu:
   $ ssh usuario@tu-servidor.com
   $ cd /home/usuario/chat-app

2. Ejecutar instalaciÃ³n automÃ¡tica:
   $ sudo bash scripts/install-ubuntu.sh

3. Â¡Listo! El script:
   âœ“ Instala Docker y Docker Compose
   âœ“ Construye imÃ¡genes
   âœ“ Inicia servicios
   âœ“ Configura crontab
   âœ“ Verifica estado

4. Acceder a la aplicaciÃ³n:
   â€¢ Frontend: http://tu-servidor.com
   â€¢ Backend: http://tu-servidor.com/api/health


OPCIÃ“N B: InstalaciÃ³n Manual
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Instalar Docker:
   $ curl -fsSL https://get.docker.com -o get-docker.sh
   $ sudo sh get-docker.sh

2. Instalar Docker Compose:
   $ sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
   $ sudo chmod +x /usr/local/bin/docker-compose

3. Clonar proyecto:
   $ cd /home/usuario
   $ git clone <tu-repositorio> chat-app
   $ cd chat-app

4. Dar permisos a scripts:
   $ chmod +x scripts/*.sh

5. Construir imÃ¡genes:
   $ docker-compose -f docker-compose.prod.yml build

6. Iniciar servicios:
   $ docker-compose -f docker-compose.prod.yml up -d

7. Configurar crontab:
   $ sudo crontab -e
   
   Agregar estas lÃ­neas:
   */2 * * * * /home/usuario/chat-app/scripts/autoscale-backend.sh >> /home/usuario/chat-app/logs/autoscale-backend.log 2>&1
   */5 * * * * /home/usuario/chat-app/scripts/autoscale-frontend.sh >> /home/usuario/chat-app/logs/autoscale-frontend.log 2>&1

8. Verificar:
   $ docker-compose ps
   $ curl http://localhost


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

4ï¸âƒ£  CÃ“MO MONITOREAR
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

VER ESTADO EN TIEMPO REAL:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

$ watch -n 2 'docker-compose ps'

Ver todos los contenedores:
$ docker ps

Ver logs:
$ docker-compose logs -f

Ver logs de autoescalado backend:
$ tail -f logs/autoscale-backend.log

Ver logs de autoescalado frontend:
$ tail -f logs/autoscale-frontend.log


VER ESTADO DEL AUTOESCALADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

$ bash scripts/autoscale-backend.sh --status
$ bash scripts/autoscale-frontend.sh --status

Ver configuraciÃ³n:
$ bash scripts/autoscale-backend.sh --config
$ bash scripts/autoscale-frontend.sh --config


VER BACKENDS ACTIVOS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

$ docker ps --filter "name=chat_backend" --format "table {{.Names}}\t{{.Status}}"

Contar backends:
$ docker ps --filter "name=chat_backend" --format "{{.Names}}" | wc -l


COMANDOS ÃšTILES:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# Ver uso de recursos
$ docker stats

# Ver logs de un backend especÃ­fico
$ docker logs chat_backend_1

# Reiniciar un servicio
$ docker-compose restart backend

# Detener todo
$ docker-compose down

# Iniciar todo
$ docker-compose -f docker-compose.prod.yml up -d

# Conectar a BD PostgreSQL
$ docker exec -it chat_db psql -U chatuser -d chatdb

# Ver conexiones activas en BD
$ docker exec chat_db psql -U chatuser -d chatdb -c "SELECT count(*) FROM pg_stat_activity;"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

5ï¸âƒ£  ESTRUCTURA DE ARQUITECTURA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

DIAGRAMA GENERAL:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

                        INTERNET
                           â”‚
                           â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   NGINX         â”‚
                  â”‚ (Reverse Proxy) â”‚
                  â”‚  Puerto 80/443  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“                             â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Frontendâ”‚              â”‚ Upstream Backend â”‚
        â”‚(Nginx) â”‚              â”‚ (Load Balancer)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”œâ”€ Backend 1:3000 â”‚
                                â”œâ”€ Backend 2:3000 â”‚
                                â”œâ”€ Backend 3:3000 â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â†“
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  PostgreSQL      â”‚
                                â”‚  (BD Ãšnica)      â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


FLUJO DE AUTOESCALADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Crontab (cada 2 minutos)
    â†“
autoscale-backend.sh
    â”œâ”€ Obtiene CPU, Memoria
    â”œâ”€ Cuenta backends activos
    â”œâ”€ Si CPU > 50% â†’ Crear backend
    â”œâ”€ Si CPU < 30% â†’ Eliminar backend
    â””â”€ Registra en logs
    â†“
NGINX detecta cambios
    â†“
Distribuye trÃ¡fico entre backends


COMPONENTES:
â”â”â”â”â”â”â”â”â”â”

1. NGINX (Reverse Proxy)
   â€¢ Punto de entrada Ãºnico
   â€¢ Balanceo de carga (least_conn)
   â€¢ Upstream: backend1, backend2, backend3
   â€¢ Puertos: 80 (HTTP), 443 (HTTPS)
   â€¢ RÃ©plicas: 1 (no se escala)

2. Frontend (HTML/CSS/JS)
   â€¢ Interfaz web moderna
   â€¢ Chat en tiempo real
   â€¢ Servidor: Nginx (puerto 80 interno)
   â€¢ RÃ©plicas: 1 (puede escalarse)

3. Backend (Node.js + Express)
   â€¢ API REST
   â€¢ WebSocket con Socket.io
   â€¢ Puerto: 3000 (interno)
   â€¢ RÃ©plicas: 1-5 (autoescalado)
   â€¢ Healthcheck: /health

4. PostgreSQL (Base de Datos)
   â€¢ BD Ãºnica compartida
   â€¢ Puerto: 5432 (solo desde backend)
   â€¢ RÃ©plicas: 1 (NO se escala)
   â€¢ Volumen persistente


CONFIGURACIÃ“N DE AUTOESCALADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Archivo: config/autoscale.conf

CPU_THRESHOLD=50              # Escalar arriba si > 50%
MIN_REPLICAS=1                # MÃ­nimo de backends
MAX_REPLICAS=5                # MÃ¡ximo de backends
SCALE_UP_COOLDOWN=30          # Espera entre escalados arriba
SCALE_DOWN_COOLDOWN=60        # Espera entre escalados abajo


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ PRÃ“XIMOS PASOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. â­ Lee DEPLOYMENT_UBUNTU.md (guÃ­a completa)
2. âš¡ O ejecuta QUICK_START.md (5 minutos)
3. ğŸš€ Ejecuta: sudo bash scripts/install-ubuntu.sh
4. ğŸ“Š Monitorea con: tail -f logs/autoscale-backend.log
5. ğŸ”§ Ajusta config/autoscale.conf segÃºn necesites


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ Â¡TU APLICACIÃ“N ESTÃ LISTA PARA PRODUCCIÃ“N! âœ¨

Para mÃ¡s informaciÃ³n, consulta los archivos de documentaciÃ³n.

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘  Ãšltima actualizaciÃ³n: 16/11/2025                                         â•‘
â•‘  VersiÃ³n: 2.0 (Con autoescalado automÃ¡tico)                               â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
